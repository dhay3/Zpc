# Do not use that configuration as an extend config or extend script when a profile has been
# selected that the profile's subscription url is in the $.proxy-provider.url list. If so the proxy
# nodes will be duplicated in proxies panel in Clash Verge Rev, Create a new local profile which
# contains this configuration and selected it. Or add a blank local profile to avoid it
#
# meta https://wiki.metacubex.one/config/
# emoji wiki https://emojis.wiki
# ISO 3166 https://en.wikipedia.org/wiki/List_of_ISO_3166_country_codes

#>>> Yaml Aliases Start >>>
gneral-options:
  healthCheck: &healthCheck
    url: "http://www.gstatic.com/generate_204"
    lazy: true
    interval: 600
    timeout: 5000

proxy-providers-options:
  proxyProvidersCommon: &proxyProvidersCommon
    type: http
    interval: 3600
    health-check:
      enable: true
      <<: *healthCheck

rule-providers-options:
  ruleProvidersCommon: &ruleProvidersCommon
    type: http
    format: yaml
    interval: 10368000

proxy-groups-options:
  proxyGroupsCommon: &proxyGroupsCommon
    <<: *healthCheck
    max-failed-times: 3
  proxyGroupsInclude: &proxyGroupsInclude
    include-all: true
    #include-all-proxies: false
    #include-all-providers: false
    <<: *proxyGroupsCommon
  proxyGroupsUse: &proxyGroupsUse
    use:
      - sub1
      - sub2
    <<: *proxyGroupsCommon
  proxyGroup: &proxyGroup
    proxies:
      - "ğŸ‡¦ğŸ‡· AR"
      - "ğŸ‡¦ğŸ‡º AU"
      - "ğŸ‡§ğŸ‡· BR"
      - "ğŸ‡¨ğŸ‡¦ CA"
      - "ğŸ‡©ğŸ‡ª DE"
      - "ğŸ‡ªğŸ‡¬ EG"
      - "ğŸ‡«ğŸ‡· FR"
      - "ğŸ‡­ğŸ‡° HK"
      - "ğŸ‡®ğŸ‡© ID"
      - "ğŸ‡®ğŸ‡³ IN"
      - "ğŸ‡¯ğŸ‡µ JP"
      - "ğŸ‡°ğŸ‡µ KP"
      - "ğŸ‡°ğŸ‡· KR"
      - "ğŸ‡²ğŸ‡´ MA"
      - "ğŸ‡²ğŸ‡½ MX"
      - "ğŸ‡²ğŸ‡¾ MY"
      - "ğŸ‡³ğŸ‡¬ NG"
      - "ğŸ‡³ğŸ‡± NL"
      - "ğŸ‡³ğŸ‡¿ NZ"
      - "ğŸ‡µğŸ‡­ PH"
      - "ğŸ‡µğŸ‡° PK"
      - "ğŸ‡·ğŸ‡º RU"
      - "ğŸ‡¸ğŸ‡¦ SA"
      - "ğŸ‡¸ğŸ‡¬ SG"
      - "ğŸ‡¹ğŸ‡­ TH"
      - "ğŸ‡¹ğŸ‡· TR"
      - "ğŸ‡¹ğŸ‡¼ TW"
      - "ğŸ‡ºğŸ‡¦ UA"
      - "ğŸ‡¬ğŸ‡§ UK"
      - "ğŸ‡ºğŸ‡¸ US"
      - "ğŸ‡»ğŸ‡³ VN"
  proxyGroupCombined: &proxyGroupCombined
    proxies:
      - "ğŸŒ DIRECT"
      - "ğŸš« REJECT"
      - "ğŸ«´ MANUAL"
      - "ğŸ§… TOR"
      - "ğŸ‡¦ğŸ‡· AR"
      - "ğŸ‡¦ğŸ‡º AU"
      - "ğŸ‡§ğŸ‡· BR"
      - "ğŸ‡¨ğŸ‡¦ CA"
      - "ğŸ‡©ğŸ‡ª DE"
      - "ğŸ‡ªğŸ‡¬ EG"
      - "ğŸ‡«ğŸ‡· FR"
      - "ğŸ‡­ğŸ‡° HK"
      - "ğŸ‡®ğŸ‡© ID"
      - "ğŸ‡®ğŸ‡³ IN"
      - "ğŸ‡¯ğŸ‡µ JP"
      - "ğŸ‡°ğŸ‡µ KP"
      - "ğŸ‡°ğŸ‡· KR"
      - "ğŸ‡²ğŸ‡´ MA"
      - "ğŸ‡²ğŸ‡½ MX"
      - "ğŸ‡²ğŸ‡¾ MY"
      - "ğŸ‡³ğŸ‡¬ NG"
      - "ğŸ‡³ğŸ‡± NL"
      - "ğŸ‡³ğŸ‡¿ NZ"
      - "ğŸ‡µğŸ‡­ PH"
      - "ğŸ‡µğŸ‡° PK"
      - "ğŸ‡·ğŸ‡º RU"
      - "ğŸ‡¸ğŸ‡¦ SA"
      - "ğŸ‡¸ğŸ‡¬ SG"
      - "ğŸ‡¹ğŸ‡­ TH"
      - "ğŸ‡¹ğŸ‡· TR"
      - "ğŸ‡¹ğŸ‡¼ TW"
      - "ğŸ‡ºğŸ‡¦ UA"
      - "ğŸ‡¬ğŸ‡§ UK"
      - "ğŸ‡ºğŸ‡¸ US"
      - "ğŸ‡»ğŸ‡³ VN"
      - "ğŸ³ï¸â€ğŸŒˆ Fusion"
#<<< Yaml Aliases End <<<

#>>> Genernal Configuration Start >>>
# Do not use default port for security concern
bind-address: "*"
mixed-port: 37897
redir-port: 37898
tproxy-port: 37899
external-controller: 0.0.0.0:9090
log-level: silent
allow-lan: false
ipv6: false
unified-delay: true
tcp-concurrent: true
keep-alive-interval: 300
global-client-fingerprint: random
global-ua: clash.meta
profile:
  store-selected: true
  store-fake-ip: true
#<<< Genernal Configuration End <<<

#>>> GEO Configuration Start >>>
geodata-loader: standard
geo-auto-update: true
geo-update-interval: 168
geox-url:
  geoip: "https://hub.gitmirror.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.dat"
  geosite: "https://hub.gitmirror.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
  mmdb: "https://hub.gitmirror.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country.mmdb"
  asn: "https://hub.gitmirror.com/https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb"
#<<< GEO Configuration End <<<

#>>> TUN/TAP Configuration Start >>>
tun:
  enable: true
  stack: mixed
  device: Meta
  auto-route: true
  auto-detect-interface: true
  strict-route: true
  dns-hijack:
    - any:53
  mtu: 1500
#<<< TUN/TAP Configuration End <<<

#>>> Domain Sniffing Configuration Start >>>
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80]
    TLS:
      ports: [443]
    QUIC:
      ports: [443]
  skip-domain:
    - '+.lan'
    - '+.local'
    - '+.localhost'
    - '+.home'
#<<< Domain Sniffing Configuration End <<<

#>>> DNS Configuration Start >>>
# 208.67.220.220 opendns
# 9.9.9.9 quad9
# 223.5.5.5 alidns
dns:
  enable: true
  prefer-h3: true
  ipv6: false
  use-hosts: true
  use-system-hosts: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.40.0.1/16
  fake-ip-filter:
    - '+.lan'
    - '+.local'
    - '+.localhost'
    - '+.home'
  # Default DNS nameservers for all requests
  nameserver:
    - https://223.5.5.5/dns-query#skip-cert-verify=true
  # DNS nameservers for Proxies
  proxy-server-nameserver:
    - https://9.9.9.9/dns-query#skip-cert-verify=true
  # DNS nameservers for NS records
  default-nameserver:
    - 223.5.5.5
    - 9.9.9.9
  # Fallback nameserver for requests that do not matched fallback-filter
  fallback:
    - https://9.9.9.9/dns-query#skip-cert-verify=true
  fallback-filter:
    geoip: true
    geoip-code: CN
  nameserver-policy:
    '+.openwrt.home': '192.168.2.1'
    '+.nas.home': '192.168.2.1'
    '+.rack.home': '192.168.2.1'
#<<< DNS Configuration End <<<

#>>> Proxy Providers Configuration Start >>>
# Replace url with your subscription
proxy-providers:
  sub1:
    <<: *proxyProvidersCommon
    url: "example.org"
    path: ./proxy_providers/sub.yaml
    proxy: "ğŸ‡¯ğŸ‡µ JP"
  sub2:
    <<: *proxyProvidersCommon
    url: "example.org"
    path: ./proxy_providers/sub.yaml
    proxy: "ğŸ‡¯ğŸ‡µ JP"
#<<< Proxy Providers Configuration End <<<

#>>> Rule Providers Configuration Start >>>
# https://github.com/Loyalsoldier/clash-rules
# https://github.com/blackmatrix7/ios_rule_script/tree/master/rule/Clash
#rule-providers:
#  claude:
#    <<: *ruleProvidersCommon
#    behavior: domain
#    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Claude/Claude.yaml"
#    path: ./ruleset/Claude.yaml
#<<< Rule Providers Configuration End <<<

#>>> Proxies Configuration Start >>>
# TUN must be enabled when use the TOR proxy
proxies:
  - name: "ğŸ§… TOR"
    type: socks5
    server: 127.0.0.1
    port: 9050
    udp: true
    ip-version: ipv4
#<<< Proxies Configuration End <<<

#>>> Proxy Groups(Policy) Configuration Start >>>
proxy-groups:
  - name: "ğŸŒ DIRECT"
    type: select
    proxies:
      - DIRECT
  - name: "ğŸš« REJECT"
    type: select
    proxies:
      - REJECT
  - name: "ğŸ‡¦ğŸ‡· AR"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¦ğŸ‡·|é˜¿æ ¹å»·|argentina"
  - name: "ğŸ‡¦ğŸ‡º AU"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¦ğŸ‡º|æ¾³å¤§åˆ©äºš|æ¾³å¤§åˆ©äº|australia"
  - name: "ğŸ‡§ğŸ‡· BR"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡§ğŸ‡·|å·´è¥¿|brazil"
  - name: "ğŸ‡¨ğŸ‡¦ CA"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¨ğŸ‡¦|åŠ æ‹¿å¤§|canada"
  - name: "ğŸ‡©ğŸ‡ª DE"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡©ğŸ‡ª|å¾·å›½|å¾·åœ‹|æŸæ—|æ…•å°¼é»‘|germany"
  - name: "ğŸ‡ªğŸ‡¬ EG"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡ªğŸ‡¬|åŸƒåŠ|egypt"
  - name: "ğŸ‡«ğŸ‡· FR"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡«ğŸ‡·|æ³•å›½|æ³•åœ‹|ç¦å…°å…‹|ç¦è˜­å…‹|french"
  - name: "ğŸ‡­ğŸ‡° HK"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|hongkong"
  - name: "ğŸ‡®ğŸ‡© ID"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡®ğŸ‡©|å°å°¼|indonesia"
  - name: "ğŸ‡®ğŸ‡³ IN"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡®ğŸ‡³|å°åº¦|india"
  - name: "ğŸ‡¯ğŸ‡µ JP"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|japan"
  - name: "ğŸ‡°ğŸ‡µ KP"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡°ğŸ‡µ|æœé²œ|æœé®®"
  - name: "ğŸ‡°ğŸ‡· KR"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“åœ‹"
  - name: "ğŸ‡²ğŸ‡´ MA"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡²ğŸ‡´|æ¾³é—¨|æ¾³é–€|maco"
  - name: "ğŸ‡²ğŸ‡½ MX"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡²ğŸ‡½|å¢¨è¥¿å“¥|mexico"
  - name: "ğŸ‡²ğŸ‡¾ MY"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡²ğŸ‡¾|é©¬æ¥è¥¿äºš|é¦¬ä¾†è¥¿äº|malaysia"
  - name: "ğŸ‡³ğŸ‡¬ NG"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡³ğŸ‡¬|å°¼æ—¥åˆ©äºš|nigeria"
  - name: "ğŸ‡³ğŸ‡± NL"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡³ğŸ‡±|è·å…°|è·è˜­|netherlands"
  - name: "ğŸ‡³ğŸ‡¿ NZ"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡³ğŸ‡¿|æ–°è¥¿å…°|æ–°è¥¿è˜­|zeeland"
  - name: "ğŸ‡µğŸ‡­ PH"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡µğŸ‡­|è²å¾‹å®¾|è²å¾‹è³“|philippines"
  - name: "ğŸ‡µğŸ‡° PK"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡µğŸ‡°|å·´åŸºæ–¯å¦|pakistan"
  - name: "ğŸ‡·ğŸ‡º RU"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡·ğŸ‡º|ä¿„ç½—æ–¯|ä¿„ç¾…æ–¯|russia"
  - name: "ğŸ‡¸ğŸ‡¦ SA"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¸ğŸ‡¦|æ²™ç‰¹|arabia"
  - name: "ğŸ‡¸ğŸ‡¬ SG"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|singapore"
  - name: "ğŸ‡¹ğŸ‡­ TH"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¹ğŸ‡­|æ³°å›½|æ³°åœ‹|Thailand"
  - name: "ğŸ‡¹ğŸ‡· TR"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¹ğŸ‡·|åœŸè€³å…¶|turkey"
  - name: "ğŸ‡¹ğŸ‡¼ TW"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|è‡ºç£|taiwan"
  - name: "ğŸ‡ºğŸ‡¦ UA"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡ºğŸ‡¦|ä¹Œå…‹å…°|çƒå…‹è˜­|ukrainian"
  - name: "ğŸ‡¬ğŸ‡§ UK"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡¬ğŸ‡§|è‹±|è‹±åœ‹|england|kingdom|britsh"
  - name: "ğŸ‡ºğŸ‡¸ US"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡ºğŸ‡¸|ç¾å›½|ç¾åœ‹|è¥¿é›…å›¾|è¥¿é›…åœ–|æ´›æ‰çŸ¶|æ´›æ‰ç£¯|è‰¾æ–¯æœ¬|america|states|seattle|angeles|ashburn"
  - name: "ğŸ‡»ğŸ‡³ VN"
    <<: *proxyGroupsInclude
    type: select
    filter: "(?i)ğŸ‡»ğŸ‡³|è¶Šå—|vietnam"
  - name: "ğŸ³ï¸â€ğŸŒˆ Fusion"
    <<: *proxyGroupsInclude
    type: select
    exclude-filter: "ğŸ§…"
  - name: "ğŸ«´ MANUAL"
    type: select
    proxies:
      - "ğŸŒ DIRECT"
      - "ğŸš« REJECT"
      - "ğŸ§… TOR"
      - "ğŸ‡¦ğŸ‡· AR"
      - "ğŸ‡¦ğŸ‡º AU"
      - "ğŸ‡§ğŸ‡· BR"
      - "ğŸ‡¨ğŸ‡¦ CA"
      - "ğŸ‡©ğŸ‡ª DE"
      - "ğŸ‡ªğŸ‡¬ EG"
      - "ğŸ‡«ğŸ‡· FR"
      - "ğŸ‡­ğŸ‡° HK"
      - "ğŸ‡®ğŸ‡© ID"
      - "ğŸ‡®ğŸ‡³ IN"
      - "ğŸ‡¯ğŸ‡µ JP"
      - "ğŸ‡°ğŸ‡µ KP"
      - "ğŸ‡°ğŸ‡· KR"
      - "ğŸ‡²ğŸ‡´ MA"
      - "ğŸ‡²ğŸ‡½ MX"
      - "ğŸ‡²ğŸ‡¾ MY"
      - "ğŸ‡³ğŸ‡¬ NG"
      - "ğŸ‡³ğŸ‡± NL"
      - "ğŸ‡³ğŸ‡¿ NZ"
      - "ğŸ‡µğŸ‡­ PH"
      - "ğŸ‡µğŸ‡° PK"
      - "ğŸ‡·ğŸ‡º RU"
      - "ğŸ‡¸ğŸ‡¦ SA"
      - "ğŸ‡¸ğŸ‡¬ SG"
      - "ğŸ‡¹ğŸ‡­ TH"
      - "ğŸ‡¹ğŸ‡· TR"
      - "ğŸ‡¹ğŸ‡¼ TW"
      - "ğŸ‡ºğŸ‡¦ UA"
      - "ğŸ‡¬ğŸ‡§ UK"
      - "ğŸ‡ºğŸ‡¸ US"
      - "ğŸ‡»ğŸ‡³ VN"
      - "ğŸ³ï¸â€ğŸŒˆ Fusion"
  - name: "ğŸš˜ Auto"
    type: url-test
    tolerance: 100
    max-failed-times: 3
    <<: *proxyGroup
  - name: "ğŸ”™ Fallback"
    type: fallback
    url: 'https://www.gstatic.com/generate_204'
    max-failed-times: 3
    <<: *proxyGroup
  - name: "ğŸ”Š ADS"
    type: select
    proxies:
      - "ğŸŒ DIRECT"
      - "ğŸš« REJECT"
      - "ğŸ«´ MANUAL"
  - name: "ğŸ¤– AI"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ Apple"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ‡¬ Google"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ§ª YouTube"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ¥… Netflix"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ­ Disney"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ‘Œ HBO"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ§™ğŸ¿â€â™€ï¸ Twitch"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ¦ Twitter"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ“² Telegram"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸš‚ Steam"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸªŸ Microsoft"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ“ˆ IPinfo"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ‘‚ Spotify"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸ€„ Manchuria"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸªœ Proxy"
    type: select
    <<: *proxyGroupCombined
  - name: "ğŸŸ Leakage"
    type: select
    <<: *proxyGroupCombined
#<<< Proxy Groups(Policy) Configuration End <<<

#>>> Rules Configuration End >>>
rules:
  - GEOIP,PRIVATE,ğŸŒ DIRECT,no-resolve
  - GEOSITE,private,ğŸŒ DIRECT
  - GEOSITE,category-ads-all,ğŸ”Š ADS
  - IP-CIDR,9.9.9.9/32,ğŸŒ DIRECT,no-resolve
  - GEOSITE,speedtest,ğŸ“ˆ IPinfo
  - DOMAIN,fast.com,ğŸ“ˆ IPinfo
  - DOMAIN,check.torproject.org,ğŸ“ˆ IPinfo
  - DOMAIN-SUFFIX,myip.la,ğŸ“ˆ IPinfo
  - DOMAIN-SUFFIX,ipip.net,ğŸ“ˆ IPinfo
  - DOMAIN-SUFFIX,ipinfo.io,ğŸ“ˆ IPinfo
  - GEOSITE,google,ğŸ‡¬ Google
  - GEOSITE,youtube,ğŸ§ª YouTube
  - GEOSITE,netflix,ğŸ¥… Netflix
  - GEOSITE,disney,ğŸ­ Disney
  - GEOSITE,hbo,ğŸ‘Œ HBO
  - GEOSITE,openai,ğŸ¤– AI
  - GEOSITE,anthropic,ğŸ¤– AI
  - GEOSITE,twitch,ğŸ§™ğŸ¿â€â™€ï¸ Twitch
  - GEOSITE,twitter,ğŸ¦ Twitter
  - GEOSITE,telegram,ğŸ“² Telegram
  - GEOSITE,spotify,ğŸ‘‚ Spotify
  - GEOSITE,microsoft@cn,ğŸŒ DIRECT
  - GEOSITE,microsoft,ğŸªŸ Microsoft
  - GEOSITE,apple@cn,ğŸŒ DIRECT
  - GEOSITE,apple,ğŸ Apple
  - GEOSITE,steam@cn,ğŸŒ DIRECT
  - GEOSITE,steam,ğŸš‚ Steam
  - GEOSITE,bilibili,ğŸ€„ Manchuria
  - GEOSITE,zhihu,ğŸ€„ Manchuria
  - GEOSITE,douban,ğŸ€„ Manchuria
  - GEOSITE,smzdm,ğŸ€„ Manchuria
  - DOMAIN-SUFFIX,linux.do,ğŸŒ DIRECT
  - GEOIP,CN,ğŸŒ DIRECT,no-resolve
  - GEOSITE,cn,ğŸŒ DIRECT
  - GEOSITE,geolocation-!cn,ğŸªœ Proxy
  - MATCH,ğŸŸ Leakage
#<<< Rules Configuration End <<<
